---
title: "Week 9"
author: "Chandeesh"
date: "2025-09-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

Download datasets
```{r}
install.packages("seqinr")
install.packages("R.utils")
```


```{r}
suppressPackageStartupMessages({
  library("seqinr") 
  library("R.utils") 
})
```

Download fasta files and unzip
```{r}
library("R.utils")

URL="http://ftp.ensemblgenomes.org/pub/bacteria/release-53/fasta/bacteria_0_collection/escherichia_coli_str_k_12_substr_mg1655_gca_000005845/cds/Escherichia_coli_str_k_12_substr_mg1655_gca_000005845.ASM584v2.cds.all.fa.gz"
download.file(URL,destfile="ecoli_cds.fa.gz")
gunzip("ecoli_cds.fa.gz")
list.files()
```

Knowing structure of the dataset
```{r}
library("seqinr")
cds <- seqinr::read.fasta("ecoli_cds.fa")
str(head(cds))
```

Basic functions using dataset
```{r}
length(cds)
head(summary(cds))
len <- as.numeric(summary(cds)[,1])
sum(len)
mean(len)
median(len)
hist(len)
hist(len,xlab="sequence length (bp)",ylab="frequency",main="histogram of coding sequence length")
boxplot(len,ylab="sequence length (bp)")
```


```{r}
GC(cds[[1]])
count(cds[[1]],1)
count(cds[[1]],2)
count(cds[[1]],3)
length(unlist(cds[1:3]))
GC(unlist(cds[1:3]))
dna_composition <- count(cds$AAC76904,1)
barplot(dna_composition,xlab="nucleotides",ylab="frequency", main="E coli CDS composition")
```

